---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import ArticleLayout from '../../components/ArticleLayout.astro';

export async function getStaticPaths() {
	const notes = await getCollection('garden');
	return notes.map((note) => ({
		params: { slug: note.slug },
		props: note,
	}));
}

const note = Astro.props;
const { Content } = await note.render();

const stageColors: Record<string, string> = {
	seedling: 'text-emerald-400 border-emerald-900/50 bg-emerald-900/10',
	budding: 'text-amber-400 border-amber-900/50 bg-amber-900/10',
	evergreen: 'text-blue-400 border-blue-900/50 bg-blue-900/10'
};
---

<Layout title={`${note.data.title} | Garden`}>
	<Header />

	<main class="pt-32 pb-20 px-6 min-h-screen">
		<article class="max-w-4xl mx-auto">
			<header class="max-w-[680px] mx-auto mb-12">
				<div class="flex items-center justify-between mb-6">
					<span class={`px-3 py-1 text-xs font-mono uppercase tracking-widest border rounded-full ${stageColors[note.data.stage] || stageColors.seedling}`}>
						{note.data.stage}
					</span>
					<span class="text-slate-500 text-sm font-mono">
						Last tended: {note.data.updatedDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
					</span>
				</div>
				<h1 class="text-4xl md:text-5xl font-bold text-white mb-6 leading-[1.15] tracking-tight" style="font-family: 'Source Serif 4', Georgia, serif;">
					{note.data.title}
				</h1>
				<p class="text-lg text-slate-300 italic font-light leading-relaxed" style="font-family: 'Source Serif 4', Georgia, serif;">
					"{note.data.description}"
				</p>
			</header>

			<ArticleLayout>
				<Content />
			</ArticleLayout>
		</article>
	</main>
</Layout>
